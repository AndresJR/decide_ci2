dist: xenial

services:
  - postgresql
addons:
  postgresql: "9.4"
before_script:
  - psql -U postgres -c "create user decide password 'decide'"
  - psql -U postgres -c "create database test_decide owner decide"
  - psql -U postgres -c "ALTER USER decide CREATEDB"
language: python
python:
  - "3.6"
install:
  - pip install -r requirements.txt
  - pip install codacy-coverage
script:
  - cd decide
  - cp travis_local_settings.py local_settings.py
  - coverage run --branch --source=. ./manage.py test mixnet --keepdb
  - coverage xml
  - python-codacy-coverage -r coverage.xml
deploy:
  provider: heroku
  app: egc-app-decide-pro
  strategy: git
  api_key:
    secure: LusxoyEbwUfTL3Ba++ZSW8M8HTZQq63KXsWAOPUlEhX74VNr7UsQP5DCCma6KMQqa16/HzwO2DfYp6BJlvRWuT+XXxXUaziNQPCw6aSzJSIFSibKenhY1CKIscUA46rvPihQ95+HRgcxox9l8hmk0Aa2r3YnVJVHvNWd6pIcEqg7OHmFTjkcF8Di4wKQmb1TTOYYAuE2scBKUCUQ6Z/tE7bAwEBEK0/giBhvhedgcK164Ajetol3dFadOo+PXXSJLTsbSfN90K5D69JtHHWYZ+PQSMqzV2y6PrmF0oUTrtcZjHSQZzpfYpafvKFmQchmkzRoKnTLp1wLG/tIjzW8jsMTcemwMOO20rYm2Wzhtzs0+ayax1TYd2AYGywn037R5e/1W2iARsw142lqp1YSe5V/NOUD+z++5iYfX1KASBOYXqKCYPLcKo/NihyMvt0jeiUYMeH7iJz41P1HEvNBEnFT4Zveg86Zk6S0TLs4YASiNiRj1E115ya07prGUkrYQ+tfhq4aY0hS8G+Sl0mevDSQJJP8VHqwFzs9qYFaq8THfx7Zals+EugVYpi03tRBbsBgWEaiNJmFgvWApTLEgdVldU79xjgp3TSq4gEY+WKZU2qFKljvMWFeP9gZEm7dmaGDORtInZ03K32Z9BSiicgoHQypvRD2eLuxpcyQhhQ=

